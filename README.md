# SQL Portfolio: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–ª—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏

–≠—Ç–æ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–∞–≤—ã–∫–∏ —Ä–∞–±–æ—Ç—ã —Å SQL –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏ `online_electronics_shop`.  

**–¶–µ–ª—å**: –ü–æ–∫–∞–∑–∞—Ç—å —É–º–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, –≤–∫–ª—é—á–∞—è JOIN, CASE, GROUP BY, –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã, –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞  
my_sql_project/  
‚îú‚îÄ‚îÄ database/  
‚îÇ ‚îî‚îÄ‚îÄ schema.sql # –î–∞–º–ø —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î (—Ç–∞–±–ª–∏—Ü—ã –∏ —Å–≤—è–∑–∏)  
‚îî‚îÄ‚îÄ queries/  
‚îú‚îÄ‚îÄ a_join_via_where.sql # –ü—Ä–∏–º–µ—Ä A: –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ WHERE  
‚îú‚îÄ‚îÄ b_inner_join.sql # –ü—Ä–∏–º–µ—Ä B: INNER JOIN —Å ON  
‚îú‚îÄ‚îÄ c_case_classification.sql # –ü—Ä–∏–º–µ—Ä C: –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ CASE  
‚îú‚îÄ‚îÄ d_group_having.sql # –ü—Ä–∏–º–µ—Ä D: –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏ HAVING  
‚îú‚îÄ‚îÄ e_left_join_reviews.sql # –ü—Ä–∏–º–µ—Ä E: LEFT JOIN —Å –æ—Ç–∑—ã–≤–∞–º–∏  
‚îú‚îÄ‚îÄ f_subquery_avg_cost.sql # –ü—Ä–∏–º–µ—Ä F: –ü–æ–¥–∑–∞–ø—Ä–æ—Å –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏  
‚îú‚îÄ‚îÄ g_order_summary_view.sql # –ü—Ä–∏–º–µ—Ä G: VIEW –¥–ª—è —Å–≤–æ–¥–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏  
‚îî‚îÄ‚îÄ h_window_time_series.sql # –ü—Ä–∏–º–µ—Ä H: –û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤  

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **–°–£–ë–î**: PostgreSQL
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**: psql, pgAdmin

---

## üìä –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### **A. –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü —á–µ—Ä–µ–∑ WHERE**  
**–§–∞–π–ª**: [a_join_via_where.sql]  
**–¶–µ–ª—å**: –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ `Orders`, `Customers` –∏ `Products` —á–µ—Ä–µ–∑ –Ω–µ—è–≤–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.  
**–ù–∞–≤—ã–∫–∏**:  
- –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü —á–µ—Ä–µ–∑ `WHERE` –∏ `=`.
  
```sql
SELECT   
    Orders.orderID as "–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–∫–∞–∑–∞",  
    Customer.fullName AS "–§–ò–û –∫–ª–∏–µ–Ω—Ç–∞",  
    Product.model AS "–ú–æ–¥–µ–ª—å —Ç–æ–≤–∞—Ä–∞",  
    OrderDetails.quantity as "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ",  
    OrderDetails.priceatorder * OrderDetails.quantity as "–°—Ç–æ–∏–º–æ—Å—Ç—å"  
FROM  
    Orders,  
    Customer,  
    OrderDetails,  
    Product  
WHERE  
    Orders.customerID = Customer.customerID  
    AND OrderDetails.orderID = Orders.orderID  
    AND OrderDetails.productID = Product.productID; 
```


### **B. INNER JOIN —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º —Å–≤—è–∑–∏**  
**–§–∞–π–ª**: [b_inner_join.sql]  
**–¶–µ–ª—å**: –£–ª—É—á—à–∏—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞ A —á–µ—Ä–µ–∑ INNER JOIN.  
**–ù–∞–≤—ã–∫–∏**:  
- –Ø–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å ON.  

SELECT  
    Orders.orderID as "–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–∫–∞–∑–∞",  
    Customer.fullName AS "–§–ò–û –∫–ª–∏–µ–Ω—Ç–∞",  
    Product.model AS "–ú–æ–¥–µ–ª—å —Ç–æ–≤–∞—Ä–∞",   
    OrderDetails.quantity as "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ",  
    OrderDetails.priceatorder * OrderDetails.quantity as "–°—Ç–æ–∏–º–æ—Å—Ç—å"  
FROM  
  Orders  
INNER JOIN  
  Customer ON Orders.customerID = Customer.customerID  
INNER JOIN  
  OrderDetails ON Orders.orderID = OrderDetails.orderID  
INNER JOIN  
  Product ON OrderDetails.productID = Product.productID;  



### **C. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤ —á–µ—Ä–µ–∑ CASE**  
**–§–∞–π–ª**: [c_case_classification.sql]  
**–¶–µ–ª—å**: –°–µ–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑—ã –ø–æ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –Ω–∞ High/Medium/Low.  
**–ù–∞–≤—ã–∫–∏**:  
- –£—Å–ª–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å CASE.  

SELECT   
    Orders.orderID as "–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–∫–∞–∑–∞",  
    Customer.fullName AS "–§–ò–û –∫–ª–∏–µ–Ω—Ç–∞",  
    OrderDetails.priceatorder * OrderDetails.quantity as "–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞",  
    CASE  
        WHEN  (OrderDetails.priceatorder * OrderDetails.quantity) > 150000 THEN 'High'  
        WHEN  (OrderDetails.priceatorder * OrderDetails.quantity) BETWEEN 75000 AND 150000 THEN 'Medium'  
        ELSE 'Low'  
    END AS "–ö–∞—Ç–µ–≥–æ—Ä–∏—è –∑–∞–∫–∞–∑–∞"  
FROM  
	Orders  
INNER JOIN  
	Customer ON Orders.customerID = Customer.customerID  
INNER JOIN  
	OrderDetails ON OrderDetails.orderid = Orders.orderid  
ORDER BY  
	OrderDetails.priceatorder * OrderDetails.quantity DESC  



### **D. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ HAVING**  
**–§–∞–π–ª**: d_group_having.sql  
**–¶–µ–ª—å**: –í—ã—è–≤–∏—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã (–∑–∞–∫–∞–∑–∞–Ω–Ω—ã–µ > 1 —Ä–∞–∑–∞).  
**–ù–∞–≤—ã–∫–∏**:  
- GROUP BY, –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (COUNT, SUM), HAVING.  

SELECT  
	Product.model,  
	COUNT(OrderDetails.OrderId) AS "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ —Å –¥–∞–Ω–Ω—ã–º —Ç–æ–≤–∞—Ä–æ–º",   
	SUM(OrderDetails.quantity) AS "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤"  
FROM  
	OrderDetails  
INNER JOIN  
	Product ON OrderDetails.Productid = Product.productid  
GROUP BY  
	Product.model  
HAVING  
	COUNT(OrderDetails.orderid)>1  



### **E. LEFT JOIN –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤**  
**–§–∞–π–ª**: e_left_join_reviews.sql  
**–¶–µ–ª—å**: –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–∫–∞–∑—ã, –≤–∫–ª—é—á–∞—è —Ç–µ, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤.  
**–ù–∞–≤—ã–∫–∏**:  
- LEFT JOIN, —Ä–∞–±–æ—Ç–∞ —Å NULL.  

SELECT  
	Orders.orderid AS "–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–∫–∞–∑–∞",   
	Customer.fullName AS "–§–ò–û –∫–ª–∏–µ–Ω—Ç–∞",  
	Orders.orderdate AS "–¥–∞—Ç–∞ –∑–∞–∫–∞–∑–∞",  
	Review.reviewText AS "–¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞",  
	Review.rating AS "–†–µ–π—Ç–∏–Ω–≥ –æ—Ç–∑—ã–≤–∞"  
FROM  
	ORDERS  
LEFT JOIN  
	Review ON Orders.orderid = Review.orderID  
LEFT JOIN  
	Customer ON Orders.customerid = Customer.customerid;  



### **F. –ü–æ–¥–∑–∞–ø—Ä–æ—Å –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Å—Ä–µ–¥–Ω–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏**  
**–§–∞–π–ª**: f_subquery_avg_cost.sql  
**–¶–µ–ª—å**: –ù–∞–π—Ç–∏ –∑–∞–∫–∞–∑—ã –¥–æ—Ä–æ–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ.  
**–ù–∞–≤—ã–∫–∏**:  
- –í–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã, WHERE —Å –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–º.  

SELECT  
	o.orderID as "–ò–¥–µ–∏–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–∫–∞–∑–∞",  
  	o.customerID as "–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞",  
	od.priceatorder * od.quantity as "–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞"  
FROM  
	Orders AS o  
INNER JOIN OrderDetails AS od  
	ON o.orderid = od.orderid  
WHERE  
	od.priceatorder * od.quantity > (  
		SELECT AVG(od.priceatorder * od.quantity)  
		FROM OrderDetails AS od  
	);  



### **G. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (VIEW)**  
**–§–∞–π–ª**: g_order_summary_view.sql  
**–¶–µ–ª—å**: –£–ø—Ä–æ—Å—Ç–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–≤–æ–¥–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞–∫–∞–∑–∞—Ö.  
**–ù–∞–≤—ã–∫–∏**:  
- –°–æ–∑–¥–∞–Ω–∏–µ VIEW, –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ JOIN.  

DROP VIEW IF EXISTS OrdersSummary; -- –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç  
CREATE VIEW OrdersSummary AS  
SELECT  
    Orders.orderid AS "–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ó–∞–∫–∞–∑–∞",  
    Customer.fullname AS "–§–ò–û –∫–ª–∏–µ–Ω—Ç–∞",  
    Orders.orderdate AS "–î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞",  
    Product.model AS "–ú–æ–¥–µ–ª—å —Ç–æ–≤–∞—Ä–∞",  
    OrderDetails.quantity AS "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ",  
    OrderDetails.priceatorder AS "–¶–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞",  
    (OrderDetails.quantity * OrderDetails.priceatorder) AS "–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–∫–∞–∑–∞",  
    Review.reviewText AS "–¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞",  
    Review.rating AS "–†–µ–π—Ç–∏–Ω–≥ –æ—Ç–∑—ã–≤–∞"  
FROM  
    Orders  
LEFT JOIN OrderDetails   
    ON Orders.orderid = OrderDetails.orderid  
LEFT JOIN Product  
    ON OrderDetails.productid = Product.productid  
LEFT JOIN Review   
    ON Orders.orderid = Review.orderid  
LEFT JOIN Customer  
    ON Orders.customerid = Customer.customerid;  

SELECT*  
FROM OrdersSummary  



### **H. –û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤**  
**–§–∞–π–ª**: h_window_time_series.sql  
**–¶–µ–ª—å**: –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—É—é –≤—ã—Ä—É—á–∫—É –ø–æ –º–µ—Å—è—Ü–∞–º.  
**–ù–∞–≤—ã–∫–∏**:  
- –û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (SUM() OVER), –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã (DATE_TRUNC).  

SELECT  
    "–ú–µ—Å—è—Ü",  
    SUM(monthly_revenue) OVER (ORDER BY "–ú–µ—Å—è—Ü") AS "–ù–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è –≤—ã—Ä—É—á–∫–∞"  
FROM (  
    SELECT  
        DATE_TRUNC('month', o.orderdate) AS "–ú–µ—Å—è—Ü",  
        SUM(od.quantity * od.priceatorder) AS monthly_revenue  
    FROM OrderDetails od  
    JOIN Orders o ON od.orderid = o.orderid  
    GROUP BY DATE_TRUNC('month', o.orderdate)  
) AS monthly_data  
ORDER BY "–ú–µ—Å—è—Ü";  
  

---

### **–ó–∞–ø—É—Å–∫**  
1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ë–î –∏–∑ –¥–∞–º–ø–∞:  

psql -U –≤–∞—à_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å -d online_electronics_shop -f database/schema.sql  

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ pgAdmin –∏–ª–∏ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É.  

---

### **–ö–æ–Ω—Ç–∞–∫—Ç—ã**
**–ê–≤—Ç–æ—Ä**: –§–µ–¥–æ—Ä–æ–≤ –í–∞—Å–∏–ª–∏–π –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á  

**Email**: vasiliy.fedorov.01@mail.ru  

---

### **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –Ω–∞ PostgreSQL 17. –î–ª—è —Ä–∞–±–æ—Ç—ã —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π PostgreSQL –∏ –ø—Ä–∞–≤–∞ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –ë–î.  

